# Yang-Zhang波动率

好的，当然。我们来详细解释一下 Yang-Zhang（简称YZ）波动率估算器。

这是一个在金融领域，特别是量化分析中，被广泛认为在理论上“最优”的历史波动率估计方法。

---

### 核心思想：它是什么？

Yang-Zhang 波动率估算器是一种利用金融资产的**开盘价（Open）、最高价（High）、最低价（Low）和收盘价（Close）**，即我们常说的OHLC数据，来计算其历史波动率的数学模型。

它的全称是“Yang-Zhang Optimal Volatility Estimator”，由 Yang 和 Zhang 在2000年的一篇论文中提出。其核心目标是提供一个比之前所有方法都更准确、偏差更小的波动率估计值。

### 为什么它被称为“最优”？

在YZ估算器出现之前，已经有多种波动率估算方法，例如：

* **Close-to-Close (收盘价对收盘价):** 最简单，但效率最低，忽略了日内价格信息。
* **Parkinson Estimator:** 只使用最高价和最低价，假设价格没有趋势（漂移）。
* **Garman-Klass Estimator:** 使用OHLC数据，比Parkinson更有效，但同样假设价格没有漂移。
* **Rogers-Satchell Estimator:** 使用OHLC数据，并且**不受价格漂移（drift）的影响**，这是一个巨大的进步。

Yang-Zhang估算器的“最优”之处在于它集各家之长，并克服了它们的缺点：

1.  **独立于漂移项 (Drift-Independent):** 和 Rogers-Satchell 一样，无论资产价格是在上涨趋势、下跌趋势还是盘整，YZ估算器的结果都是无偏的。这是非常重要的一个特性，因为大多数资产在长期内都有趋势（漂移）。
2.  **考虑了隔夜跳空 (Accounts for Opening Gaps):** 很多估算器只关注交易时段内的波动（日内波动），但忽略了前一天的收盘价到今天开盘价之间的价格跳空。这种“隔夜波”动是总波动的重要组成部分。YZ估算器巧妙地将这部分波动也包含了进来。
3.  **拥有最小估计方差 (Minimum Estimation Variance):** 在所有无偏的、独立于漂移项的波动率估算器中，Yang-Zhang 估算器的估计结果方差是最小的。通俗地说，就是它的**估计结果最稳定、最精确**，随机误差最小。

因此，Yang-Zhang估算器被认为是结合了**准确性（无偏）**和**稳定性（最小方差）**的最佳模型。

### 数学公式

Yang-Zhang波动率的方差（$\sigma^2$）估计公式如下：

$$\sigma_{YZ}^2 = \sigma_{O}^2 + k \cdot \sigma_{C}^2 + (1-k) \cdot \sigma_{RS}^2$$

这个公式看起来复杂，但其实是三个部分的加权平均，每一部分都有明确的含义：

* $\sigma_{O}^2$ (隔夜波动率, Overnight Volatility): 捕捉从前一天收盘到当天开盘的价格跳动。
* $\sigma_{C}^2$ (日内收盘价对开盘价波动率, Close-to-Open Volatility): 捕捉从当天开盘到当天收盘的波动。
* $\sigma_{RS}^2$ (Rogers-Satchell波动率): 这是一个经典的、不受趋势影响的日内波动率估算器。

我们来分解一下每个部分的具体计算：

1.  **隔夜波动率 ($\sigma_O^2$):**
    $$
    \sigma_O^2 = \frac{1}{n-1} \sum_{i=1}^{n} \left( \ln\left(\frac{O_i}{C_{i-1}}\right) - \bar{o} \right)^2
    $$
    其中：
    * $O_i$ 是第 $i$ 天的开盘价。
    * $C_{i-1}$ 是第 $i-1$ 天的收盘价。
    * $\bar{o}$ 是 $\ln(O_i / C_{i-1})$ 的平均值。

2.  **日内收盘价对开盘价波动率 ($\sigma_C^2$):**
    $$
    \sigma_C^2 = \frac{1}{n-1} \sum_{i=1}^{n} \left( \ln\left(\frac{C_i}{O_i}\right) - \bar{c} \right)^2
    $$
    其中：
    * $C_i$ 是第 $i$ 天的收盘价。
    * $O_i$ 是第 $i$ 天的开盘价。
    * $\bar{c}$ 是 $\ln(C_i / O_i)$ 的平均值。

3.  **Rogers-Satchell 波动率 ($\sigma_{RS}^2$):**
    $$
    \sigma_{RS}^2 = \frac{1}{n} \sum_{i=1}^{n} \left[ \ln\left(\frac{H_i}{C_i}\right) \ln\left(\frac{H_i}{O_i}\right) + \ln\left(\frac{L_i}{C_i}\right) \ln\left(\frac{L_i}{O_i}\right) \right]
    $$
    其中：
    * $H_i$ 是第 $i$ 天的最高价。
    * $L_i$ 是第 $i$ 天的最低价。

4.  **权重因子 (k):**
    $$
    k = \frac{0.34}{1.34 + \frac{n+1}{n-1}}
    $$

将这几部分组合起来，就得到了最终的Yang-Zhang方差估计值 $\sigma_{YZ}^2$。要得到波动率 $\sigma_{YZ}$，只需将其开方即可。